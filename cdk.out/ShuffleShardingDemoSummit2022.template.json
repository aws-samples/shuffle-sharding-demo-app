{
  "Resources": {
    "vpcA2121C38": {
      "Type": "AWS::EC2::VPC",
      "Properties": {
        "CidrBlock": "10.0.0.0/16",
        "EnableDnsHostnames": true,
        "EnableDnsSupport": true,
        "InstanceTenancy": "default",
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/Resource"
      }
    },
    "vpcPublicSubnet1Subnet2E65531E": {
      "Type": "AWS::EC2::Subnet",
      "Properties": {
        "CidrBlock": "10.0.0.0/18",
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "AvailabilityZone": {
          "Fn::Select": [
            0,
            {
              "Fn::GetAZs": ""
            }
          ]
        },
        "MapPublicIpOnLaunch": true,
        "Tags": [
          {
            "Key": "aws-cdk:subnet-name",
            "Value": "Public"
          },
          {
            "Key": "aws-cdk:subnet-type",
            "Value": "Public"
          },
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1/Subnet"
      }
    },
    "vpcPublicSubnet1RouteTable48A2DF9B": {
      "Type": "AWS::EC2::RouteTable",
      "Properties": {
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1/RouteTable"
      }
    },
    "vpcPublicSubnet1RouteTableAssociation5D3F4579": {
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
      "Properties": {
        "RouteTableId": {
          "Ref": "vpcPublicSubnet1RouteTable48A2DF9B"
        },
        "SubnetId": {
          "Ref": "vpcPublicSubnet1Subnet2E65531E"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1/RouteTableAssociation"
      }
    },
    "vpcPublicSubnet1DefaultRoute10708846": {
      "Type": "AWS::EC2::Route",
      "Properties": {
        "RouteTableId": {
          "Ref": "vpcPublicSubnet1RouteTable48A2DF9B"
        },
        "DestinationCidrBlock": "0.0.0.0/0",
        "GatewayId": {
          "Ref": "vpcIGWE57CBDCA"
        }
      },
      "DependsOn": [
        "vpcVPCGW7984C166"
      ],
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1/DefaultRoute"
      }
    },
    "vpcPublicSubnet1EIPDA49DCBE": {
      "Type": "AWS::EC2::EIP",
      "Properties": {
        "Domain": "vpc",
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1/EIP"
      }
    },
    "vpcPublicSubnet1NATGateway9C16659E": {
      "Type": "AWS::EC2::NatGateway",
      "Properties": {
        "SubnetId": {
          "Ref": "vpcPublicSubnet1Subnet2E65531E"
        },
        "AllocationId": {
          "Fn::GetAtt": [
            "vpcPublicSubnet1EIPDA49DCBE",
            "AllocationId"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet1/NATGateway"
      }
    },
    "vpcPublicSubnet2Subnet009B674F": {
      "Type": "AWS::EC2::Subnet",
      "Properties": {
        "CidrBlock": "10.0.64.0/18",
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "AvailabilityZone": {
          "Fn::Select": [
            1,
            {
              "Fn::GetAZs": ""
            }
          ]
        },
        "MapPublicIpOnLaunch": true,
        "Tags": [
          {
            "Key": "aws-cdk:subnet-name",
            "Value": "Public"
          },
          {
            "Key": "aws-cdk:subnet-type",
            "Value": "Public"
          },
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2/Subnet"
      }
    },
    "vpcPublicSubnet2RouteTableEB40D4CB": {
      "Type": "AWS::EC2::RouteTable",
      "Properties": {
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2/RouteTable"
      }
    },
    "vpcPublicSubnet2RouteTableAssociation21F81B59": {
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
      "Properties": {
        "RouteTableId": {
          "Ref": "vpcPublicSubnet2RouteTableEB40D4CB"
        },
        "SubnetId": {
          "Ref": "vpcPublicSubnet2Subnet009B674F"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2/RouteTableAssociation"
      }
    },
    "vpcPublicSubnet2DefaultRouteA1EC0F60": {
      "Type": "AWS::EC2::Route",
      "Properties": {
        "RouteTableId": {
          "Ref": "vpcPublicSubnet2RouteTableEB40D4CB"
        },
        "DestinationCidrBlock": "0.0.0.0/0",
        "GatewayId": {
          "Ref": "vpcIGWE57CBDCA"
        }
      },
      "DependsOn": [
        "vpcVPCGW7984C166"
      ],
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2/DefaultRoute"
      }
    },
    "vpcPublicSubnet2EIP9B3743B1": {
      "Type": "AWS::EC2::EIP",
      "Properties": {
        "Domain": "vpc",
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2/EIP"
      }
    },
    "vpcPublicSubnet2NATGateway9B8AE11A": {
      "Type": "AWS::EC2::NatGateway",
      "Properties": {
        "SubnetId": {
          "Ref": "vpcPublicSubnet2Subnet009B674F"
        },
        "AllocationId": {
          "Fn::GetAtt": [
            "vpcPublicSubnet2EIP9B3743B1",
            "AllocationId"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PublicSubnet2/NATGateway"
      }
    },
    "vpcPrivateSubnet1Subnet934893E8": {
      "Type": "AWS::EC2::Subnet",
      "Properties": {
        "CidrBlock": "10.0.128.0/18",
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "AvailabilityZone": {
          "Fn::Select": [
            0,
            {
              "Fn::GetAZs": ""
            }
          ]
        },
        "MapPublicIpOnLaunch": false,
        "Tags": [
          {
            "Key": "aws-cdk:subnet-name",
            "Value": "Private"
          },
          {
            "Key": "aws-cdk:subnet-type",
            "Value": "Private"
          },
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet1/Subnet"
      }
    },
    "vpcPrivateSubnet1RouteTableB41A48CC": {
      "Type": "AWS::EC2::RouteTable",
      "Properties": {
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet1/RouteTable"
      }
    },
    "vpcPrivateSubnet1RouteTableAssociation67945127": {
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
      "Properties": {
        "RouteTableId": {
          "Ref": "vpcPrivateSubnet1RouteTableB41A48CC"
        },
        "SubnetId": {
          "Ref": "vpcPrivateSubnet1Subnet934893E8"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet1/RouteTableAssociation"
      }
    },
    "vpcPrivateSubnet1DefaultRoute1AA8E2E5": {
      "Type": "AWS::EC2::Route",
      "Properties": {
        "RouteTableId": {
          "Ref": "vpcPrivateSubnet1RouteTableB41A48CC"
        },
        "DestinationCidrBlock": "0.0.0.0/0",
        "NatGatewayId": {
          "Ref": "vpcPublicSubnet1NATGateway9C16659E"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet1/DefaultRoute"
      }
    },
    "vpcPrivateSubnet2Subnet7031C2BA": {
      "Type": "AWS::EC2::Subnet",
      "Properties": {
        "CidrBlock": "10.0.192.0/18",
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "AvailabilityZone": {
          "Fn::Select": [
            1,
            {
              "Fn::GetAZs": ""
            }
          ]
        },
        "MapPublicIpOnLaunch": false,
        "Tags": [
          {
            "Key": "aws-cdk:subnet-name",
            "Value": "Private"
          },
          {
            "Key": "aws-cdk:subnet-type",
            "Value": "Private"
          },
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet2"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet2/Subnet"
      }
    },
    "vpcPrivateSubnet2RouteTable7280F23E": {
      "Type": "AWS::EC2::RouteTable",
      "Properties": {
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet2"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet2/RouteTable"
      }
    },
    "vpcPrivateSubnet2RouteTableAssociation007E94D3": {
      "Type": "AWS::EC2::SubnetRouteTableAssociation",
      "Properties": {
        "RouteTableId": {
          "Ref": "vpcPrivateSubnet2RouteTable7280F23E"
        },
        "SubnetId": {
          "Ref": "vpcPrivateSubnet2Subnet7031C2BA"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet2/RouteTableAssociation"
      }
    },
    "vpcPrivateSubnet2DefaultRouteB0E07F99": {
      "Type": "AWS::EC2::Route",
      "Properties": {
        "RouteTableId": {
          "Ref": "vpcPrivateSubnet2RouteTable7280F23E"
        },
        "DestinationCidrBlock": "0.0.0.0/0",
        "NatGatewayId": {
          "Ref": "vpcPublicSubnet2NATGateway9B8AE11A"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/PrivateSubnet2/DefaultRoute"
      }
    },
    "vpcIGWE57CBDCA": {
      "Type": "AWS::EC2::InternetGateway",
      "Properties": {
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/vpc"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/IGW"
      }
    },
    "vpcVPCGW7984C166": {
      "Type": "AWS::EC2::VPCGatewayAttachment",
      "Properties": {
        "VpcId": {
          "Ref": "vpcA2121C38"
        },
        "InternetGatewayId": {
          "Ref": "vpcIGWE57CBDCA"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/vpc/VPCGW"
      }
    },
    "cwD67736ED": {
      "Type": "AWS::CloudWatch::Dashboard",
      "Properties": {
        "DashboardBody": {
          "Fn::Join": [
            "",
            [
              "{\"widgets\":[{\"type\":\"metric\",\"width\":6,\"height\":6,\"x\":0,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"activeConnectionsCount\",\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"annotations\":{\"alarms\":[\"",
              {
                "Fn::GetAtt": [
                  "activeConnectionsCount90209303",
                  "Arn"
                ]
              },
              "\"]},\"yAxis\":{}}},{\"type\":\"metric\",\"width\":6,\"height\":6,\"x\":6,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"totalConnectionsCount\",\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"annotations\":{\"alarms\":[\"",
              {
                "Fn::GetAtt": [
                  "totalConnectionsCount347BE3AF",
                  "Arn"
                ]
              },
              "\"]},\"yAxis\":{}}},{\"type\":\"metric\",\"width\":6,\"height\":6,\"x\":12,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"/?number=1\",\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"annotations\":{\"alarms\":[\"",
              {
                "Fn::GetAtt": [
                  "alarm11F7E5553",
                  "Arn"
                ]
              },
              "\"]},\"yAxis\":{}}},{\"type\":\"metric\",\"width\":6,\"height\":6,\"x\":18,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"/?number=2\",\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"annotations\":{\"alarms\":[\"",
              {
                "Fn::GetAtt": [
                  "alarm2999D08C3",
                  "Arn"
                ]
              },
              "\"]},\"yAxis\":{}}},{\"type\":\"metric\",\"width\":6,\"height\":6,\"x\":0,\"y\":6,\"properties\":{\"view\":\"timeSeries\",\"title\":\"main (/)\",\"region\":\"",
              {
                "Ref": "AWS::Region"
              },
              "\",\"annotations\":{\"alarms\":[\"",
              {
                "Fn::GetAtt": [
                  "alarmmainB23BFCDF",
                  "Arn"
                ]
              },
              "\"]},\"yAxis\":{}}}]}"
            ]
          ]
        },
        "DashboardName": "ShuffleShardingSummit2022"
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/cw/Resource"
      }
    },
    "AppLoadBalancer0268F95E": {
      "Type": "AWS::ElasticLoadBalancingV2::LoadBalancer",
      "Properties": {
        "LoadBalancerAttributes": [
          {
            "Key": "deletion_protection.enabled",
            "Value": "false"
          }
        ],
        "Scheme": "internet-facing",
        "SecurityGroups": [
          {
            "Fn::GetAtt": [
              "AppLoadBalancerSecurityGroupC44CD584",
              "GroupId"
            ]
          }
        ],
        "Subnets": [
          {
            "Ref": "vpcPublicSubnet1Subnet2E65531E"
          },
          {
            "Ref": "vpcPublicSubnet2Subnet009B674F"
          }
        ],
        "Type": "application"
      },
      "DependsOn": [
        "vpcPublicSubnet1DefaultRoute10708846",
        "vpcPublicSubnet2DefaultRouteA1EC0F60"
      ],
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/Resource"
      }
    },
    "AppLoadBalancerSecurityGroupC44CD584": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupDescription": "Automatically created Security Group for ELB ShuffleShardingDemoSummit2022AppLoadBalancer55EF14E6",
        "SecurityGroupIngress": [
          {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow from anyone on port 80",
            "FromPort": 80,
            "IpProtocol": "tcp",
            "ToPort": 80
          }
        ],
        "VpcId": {
          "Ref": "vpcA2121C38"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/SecurityGroup/Resource"
      }
    },
    "AppLoadBalancerSecurityGrouptoShuffleShardingDemoSummit2022Worker1InstanceSecurityGroup8148D3A980DC07EF48": {
      "Type": "AWS::EC2::SecurityGroupEgress",
      "Properties": {
        "GroupId": {
          "Fn::GetAtt": [
            "AppLoadBalancerSecurityGroupC44CD584",
            "GroupId"
          ]
        },
        "IpProtocol": "tcp",
        "Description": "to ShuffleShardingDemoSummit2022Worker1InstanceSecurityGroup8148D3A9:80",
        "DestinationSecurityGroupId": {
          "Fn::GetAtt": [
            "Worker1InstanceSecurityGroup59622567",
            "GroupId"
          ]
        },
        "FromPort": 80,
        "ToPort": 80
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/SecurityGroup/to ShuffleShardingDemoSummit2022Worker1InstanceSecurityGroup8148D3A9:80"
      }
    },
    "AppLoadBalancerSecurityGrouptoShuffleShardingDemoSummit2022Worker2InstanceSecurityGroup1B72995980E2008501": {
      "Type": "AWS::EC2::SecurityGroupEgress",
      "Properties": {
        "GroupId": {
          "Fn::GetAtt": [
            "AppLoadBalancerSecurityGroupC44CD584",
            "GroupId"
          ]
        },
        "IpProtocol": "tcp",
        "Description": "to ShuffleShardingDemoSummit2022Worker2InstanceSecurityGroup1B729959:80",
        "DestinationSecurityGroupId": {
          "Fn::GetAtt": [
            "Worker2InstanceSecurityGroup23BD1914",
            "GroupId"
          ]
        },
        "FromPort": 80,
        "ToPort": 80
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/SecurityGroup/to ShuffleShardingDemoSummit2022Worker2InstanceSecurityGroup1B729959:80"
      }
    },
    "AppLoadBalancerSecurityGrouptoShuffleShardingDemoSummit2022Worker3InstanceSecurityGroup5AB6ED358044AB1314": {
      "Type": "AWS::EC2::SecurityGroupEgress",
      "Properties": {
        "GroupId": {
          "Fn::GetAtt": [
            "AppLoadBalancerSecurityGroupC44CD584",
            "GroupId"
          ]
        },
        "IpProtocol": "tcp",
        "Description": "to ShuffleShardingDemoSummit2022Worker3InstanceSecurityGroup5AB6ED35:80",
        "DestinationSecurityGroupId": {
          "Fn::GetAtt": [
            "Worker3InstanceSecurityGroup8D987E06",
            "GroupId"
          ]
        },
        "FromPort": 80,
        "ToPort": 80
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/SecurityGroup/to ShuffleShardingDemoSummit2022Worker3InstanceSecurityGroup5AB6ED35:80"
      }
    },
    "AppLoadBalancerSecurityGrouptoShuffleShardingDemoSummit2022Worker4InstanceSecurityGroup299E234E80D4F99100": {
      "Type": "AWS::EC2::SecurityGroupEgress",
      "Properties": {
        "GroupId": {
          "Fn::GetAtt": [
            "AppLoadBalancerSecurityGroupC44CD584",
            "GroupId"
          ]
        },
        "IpProtocol": "tcp",
        "Description": "to ShuffleShardingDemoSummit2022Worker4InstanceSecurityGroup299E234E:80",
        "DestinationSecurityGroupId": {
          "Fn::GetAtt": [
            "Worker4InstanceSecurityGroupAB185FF0",
            "GroupId"
          ]
        },
        "FromPort": 80,
        "ToPort": 80
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/SecurityGroup/to ShuffleShardingDemoSummit2022Worker4InstanceSecurityGroup299E234E:80"
      }
    },
    "AppLoadBalancerAppMainListener100632E2": {
      "Type": "AWS::ElasticLoadBalancingV2::Listener",
      "Properties": {
        "DefaultActions": [
          {
            "FixedResponseConfig": {
              "MessageBody": "Invalid Request. Please include specific key",
              "StatusCode": "400"
            },
            "Type": "fixed-response"
          }
        ],
        "LoadBalancerArn": {
          "Ref": "AppLoadBalancer0268F95E"
        },
        "Port": 80,
        "Protocol": "HTTP"
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/AppMainListener/Resource"
      }
    },
    "AppLoadBalancerAppMainListenerWorker1Worker2Rule60B444E5": {
      "Type": "AWS::ElasticLoadBalancingV2::ListenerRule",
      "Properties": {
        "Actions": [
          {
            "TargetGroupArn": {
              "Ref": "Worker1Worker204A96BDA"
            },
            "Type": "forward"
          }
        ],
        "Conditions": [
          {
            "Field": "query-string",
            "QueryStringConfig": {
              "Values": [
                {
                  "Key": "number",
                  "Value": "1"
                }
              ]
            }
          }
        ],
        "ListenerArn": {
          "Ref": "AppLoadBalancerAppMainListener100632E2"
        },
        "Priority": 1
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/AppMainListener/Worker1-Worker2Rule/Resource"
      }
    },
    "AppLoadBalancerAppMainListenerWorker3Worker4Rule02549A56": {
      "Type": "AWS::ElasticLoadBalancingV2::ListenerRule",
      "Properties": {
        "Actions": [
          {
            "TargetGroupArn": {
              "Ref": "Worker3Worker4B1041CD7"
            },
            "Type": "forward"
          }
        ],
        "Conditions": [
          {
            "Field": "query-string",
            "QueryStringConfig": {
              "Values": [
                {
                  "Key": "number",
                  "Value": "2"
                }
              ]
            }
          }
        ],
        "ListenerArn": {
          "Ref": "AppLoadBalancerAppMainListener100632E2"
        },
        "Priority": 2
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/AppLoadBalancer/AppMainListener/Worker3-Worker4Rule/Resource"
      }
    },
    "activeConnectionsCount90209303": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "ComparisonOperator": "LessThanThreshold",
        "EvaluationPeriods": 1,
        "DatapointsToAlarm": 1,
        "Dimensions": [
          {
            "Name": "LoadBalancer",
            "Value": {
              "Fn::GetAtt": [
                "AppLoadBalancer0268F95E",
                "LoadBalancerFullName"
              ]
            }
          }
        ],
        "MetricName": "ActiveConnectionCount",
        "Namespace": "AWS/ApplicationELB",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 10
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/activeConnectionsCount/Resource"
      }
    },
    "totalConnectionsCount347BE3AF": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "ComparisonOperator": "LessThanThreshold",
        "EvaluationPeriods": 1,
        "DatapointsToAlarm": 1,
        "Dimensions": [
          {
            "Name": "LoadBalancer",
            "Value": {
              "Fn::GetAtt": [
                "AppLoadBalancer0268F95E",
                "LoadBalancerFullName"
              ]
            }
          }
        ],
        "MetricName": "RequestCount",
        "Namespace": "AWS/ApplicationELB",
        "Period": 300,
        "Statistic": "Sum",
        "Threshold": 10
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/totalConnectionsCount/Resource"
      }
    },
    "Worker1InstanceSecurityGroup59622567": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupDescription": "ShuffleShardingDemoSummit2022/Worker1/InstanceSecurityGroup",
        "SecurityGroupEgress": [
          {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker1"
          }
        ],
        "VpcId": {
          "Ref": "vpcA2121C38"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker1/InstanceSecurityGroup/Resource"
      }
    },
    "Worker1InstanceSecurityGroupfromShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA4542480B350A71F": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "Description": "from ShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424:80",
        "FromPort": 80,
        "GroupId": {
          "Fn::GetAtt": [
            "Worker1InstanceSecurityGroup59622567",
            "GroupId"
          ]
        },
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "AppLoadBalancerSecurityGroupC44CD584",
            "GroupId"
          ]
        },
        "ToPort": 80
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker1/InstanceSecurityGroup/from ShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424:80"
      }
    },
    "Worker1InstanceRoleC8F05946": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": {
                  "Fn::Join": [
                    "",
                    [
                      "ec2.",
                      {
                        "Ref": "AWS::URLSuffix"
                      }
                    ]
                  ]
                }
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/AmazonSSMManagedInstanceCore"
              ]
            ]
          },
          {
            "Ref": "Worker1readTagsDFE7409E"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker1/InstanceRole/Resource"
      }
    },
    "Worker1InstanceProfileED7A1457": {
      "Type": "AWS::IAM::InstanceProfile",
      "Properties": {
        "Roles": [
          {
            "Ref": "Worker1InstanceRoleC8F05946"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker1/InstanceProfile"
      }
    },
    "Worker1C6282B125756e0f615c1f3fd": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::Select": [
            0,
            {
              "Fn::GetAZs": ""
            }
          ]
        },
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "VolumeSize": 50,
              "VolumeType": "gp3"
            }
          }
        ],
        "IamInstanceProfile": {
          "Ref": "Worker1InstanceProfileED7A1457"
        },
        "ImageId": {
          "Ref": "SsmParameterValueawsserviceamiamazonlinuxlatestamzn2amihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter"
        },
        "InstanceType": "t3.medium",
        "SecurityGroupIds": [
          {
            "Fn::GetAtt": [
              "Worker1InstanceSecurityGroup59622567",
              "GroupId"
            ]
          }
        ],
        "SubnetId": {
          "Ref": "vpcPrivateSubnet1Subnet934893E8"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker1"
          }
        ],
        "UserData": {
          "Fn::Base64": "#!/bin/bash -x\nyum update -y\nyum install python-pip -y\npip install flask\npip install boto3\npip install ec2-metadata\ncurl -o /home/ec2-user/buggy-webserver.py https://aws-well-architected-labs-virginia.s3.amazonaws.com/Reliability/300_Fault_Isolation_with_Shuffle_Sharding/buggy-webserver.py\nnohup python /home/ec2-user/buggy-webserver.py >>/var/log/webserver.log 2>&1 &"
        }
      },
      "DependsOn": [
        "Worker1InstanceRoleC8F05946"
      ],
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker1/Resource"
      }
    },
    "Worker1readTagsDFE7409E": {
      "Type": "AWS::IAM::ManagedPolicy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "ec2:DescribeTags",
              "Effect": "Allow",
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "Description": "",
        "Path": "/"
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker1readTags/Resource"
      }
    },
    "Worker2InstanceSecurityGroup23BD1914": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupDescription": "ShuffleShardingDemoSummit2022/Worker2/InstanceSecurityGroup",
        "SecurityGroupEgress": [
          {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker2"
          }
        ],
        "VpcId": {
          "Ref": "vpcA2121C38"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker2/InstanceSecurityGroup/Resource"
      }
    },
    "Worker2InstanceSecurityGroupfromShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA4542480C8C06394": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "Description": "from ShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424:80",
        "FromPort": 80,
        "GroupId": {
          "Fn::GetAtt": [
            "Worker2InstanceSecurityGroup23BD1914",
            "GroupId"
          ]
        },
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "AppLoadBalancerSecurityGroupC44CD584",
            "GroupId"
          ]
        },
        "ToPort": 80
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker2/InstanceSecurityGroup/from ShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424:80"
      }
    },
    "Worker2InstanceRole4CE57811": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": {
                  "Fn::Join": [
                    "",
                    [
                      "ec2.",
                      {
                        "Ref": "AWS::URLSuffix"
                      }
                    ]
                  ]
                }
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/AmazonSSMManagedInstanceCore"
              ]
            ]
          },
          {
            "Ref": "Worker2readTags643E321C"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker2"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker2/InstanceRole/Resource"
      }
    },
    "Worker2InstanceProfile7D1FBEB1": {
      "Type": "AWS::IAM::InstanceProfile",
      "Properties": {
        "Roles": [
          {
            "Ref": "Worker2InstanceRole4CE57811"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker2/InstanceProfile"
      }
    },
    "Worker21CDE475D5756e0f615c1f3fd": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::Select": [
            0,
            {
              "Fn::GetAZs": ""
            }
          ]
        },
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "VolumeSize": 50,
              "VolumeType": "gp3"
            }
          }
        ],
        "IamInstanceProfile": {
          "Ref": "Worker2InstanceProfile7D1FBEB1"
        },
        "ImageId": {
          "Ref": "SsmParameterValueawsserviceamiamazonlinuxlatestamzn2amihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter"
        },
        "InstanceType": "t3.medium",
        "SecurityGroupIds": [
          {
            "Fn::GetAtt": [
              "Worker2InstanceSecurityGroup23BD1914",
              "GroupId"
            ]
          }
        ],
        "SubnetId": {
          "Ref": "vpcPrivateSubnet1Subnet934893E8"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker2"
          }
        ],
        "UserData": {
          "Fn::Base64": "#!/bin/bash -x\nyum update -y\nyum install python-pip -y\npip install flask\npip install boto3\npip install ec2-metadata\ncurl -o /home/ec2-user/buggy-webserver.py https://aws-well-architected-labs-virginia.s3.amazonaws.com/Reliability/300_Fault_Isolation_with_Shuffle_Sharding/buggy-webserver.py\nnohup python /home/ec2-user/buggy-webserver.py >>/var/log/webserver.log 2>&1 &"
        }
      },
      "DependsOn": [
        "Worker2InstanceRole4CE57811"
      ],
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker2/Resource"
      }
    },
    "Worker2readTags643E321C": {
      "Type": "AWS::IAM::ManagedPolicy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "ec2:DescribeTags",
              "Effect": "Allow",
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "Description": "",
        "Path": "/"
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker2readTags/Resource"
      }
    },
    "Worker3InstanceSecurityGroup8D987E06": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupDescription": "ShuffleShardingDemoSummit2022/Worker3/InstanceSecurityGroup",
        "SecurityGroupEgress": [
          {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker3"
          }
        ],
        "VpcId": {
          "Ref": "vpcA2121C38"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker3/InstanceSecurityGroup/Resource"
      }
    },
    "Worker3InstanceSecurityGroupfromShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA4542480D631F650": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "Description": "from ShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424:80",
        "FromPort": 80,
        "GroupId": {
          "Fn::GetAtt": [
            "Worker3InstanceSecurityGroup8D987E06",
            "GroupId"
          ]
        },
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "AppLoadBalancerSecurityGroupC44CD584",
            "GroupId"
          ]
        },
        "ToPort": 80
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker3/InstanceSecurityGroup/from ShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424:80"
      }
    },
    "Worker3InstanceRoleE786E787": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": {
                  "Fn::Join": [
                    "",
                    [
                      "ec2.",
                      {
                        "Ref": "AWS::URLSuffix"
                      }
                    ]
                  ]
                }
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/AmazonSSMManagedInstanceCore"
              ]
            ]
          },
          {
            "Ref": "Worker3readTags6E2C7F22"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker3"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker3/InstanceRole/Resource"
      }
    },
    "Worker3InstanceProfile302920F9": {
      "Type": "AWS::IAM::InstanceProfile",
      "Properties": {
        "Roles": [
          {
            "Ref": "Worker3InstanceRoleE786E787"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker3/InstanceProfile"
      }
    },
    "Worker356A1B6C45756e0f615c1f3fd": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::Select": [
            0,
            {
              "Fn::GetAZs": ""
            }
          ]
        },
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "VolumeSize": 50,
              "VolumeType": "gp3"
            }
          }
        ],
        "IamInstanceProfile": {
          "Ref": "Worker3InstanceProfile302920F9"
        },
        "ImageId": {
          "Ref": "SsmParameterValueawsserviceamiamazonlinuxlatestamzn2amihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter"
        },
        "InstanceType": "t3.medium",
        "SecurityGroupIds": [
          {
            "Fn::GetAtt": [
              "Worker3InstanceSecurityGroup8D987E06",
              "GroupId"
            ]
          }
        ],
        "SubnetId": {
          "Ref": "vpcPrivateSubnet1Subnet934893E8"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker3"
          }
        ],
        "UserData": {
          "Fn::Base64": "#!/bin/bash -x\nyum update -y\nyum install python-pip -y\npip install flask\npip install boto3\npip install ec2-metadata\ncurl -o /home/ec2-user/buggy-webserver.py https://aws-well-architected-labs-virginia.s3.amazonaws.com/Reliability/300_Fault_Isolation_with_Shuffle_Sharding/buggy-webserver.py\nnohup python /home/ec2-user/buggy-webserver.py >>/var/log/webserver.log 2>&1 &"
        }
      },
      "DependsOn": [
        "Worker3InstanceRoleE786E787"
      ],
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker3/Resource"
      }
    },
    "Worker3readTags6E2C7F22": {
      "Type": "AWS::IAM::ManagedPolicy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "ec2:DescribeTags",
              "Effect": "Allow",
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "Description": "",
        "Path": "/"
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker3readTags/Resource"
      }
    },
    "Worker4InstanceSecurityGroupAB185FF0": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupDescription": "ShuffleShardingDemoSummit2022/Worker4/InstanceSecurityGroup",
        "SecurityGroupEgress": [
          {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker4"
          }
        ],
        "VpcId": {
          "Ref": "vpcA2121C38"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker4/InstanceSecurityGroup/Resource"
      }
    },
    "Worker4InstanceSecurityGroupfromShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424803C1902DC": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "Description": "from ShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424:80",
        "FromPort": 80,
        "GroupId": {
          "Fn::GetAtt": [
            "Worker4InstanceSecurityGroupAB185FF0",
            "GroupId"
          ]
        },
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "AppLoadBalancerSecurityGroupC44CD584",
            "GroupId"
          ]
        },
        "ToPort": 80
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker4/InstanceSecurityGroup/from ShuffleShardingDemoSummit2022AppLoadBalancerSecurityGroupFAA45424:80"
      }
    },
    "Worker4InstanceRoleA8AACB09": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": {
                  "Fn::Join": [
                    "",
                    [
                      "ec2.",
                      {
                        "Ref": "AWS::URLSuffix"
                      }
                    ]
                  ]
                }
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/AmazonSSMManagedInstanceCore"
              ]
            ]
          },
          {
            "Ref": "Worker4readTags9AD8236D"
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker4"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker4/InstanceRole/Resource"
      }
    },
    "Worker4InstanceProfileEAEB7A34": {
      "Type": "AWS::IAM::InstanceProfile",
      "Properties": {
        "Roles": [
          {
            "Ref": "Worker4InstanceRoleA8AACB09"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker4/InstanceProfile"
      }
    },
    "Worker49A67C52E5756e0f615c1f3fd": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::Select": [
            0,
            {
              "Fn::GetAZs": ""
            }
          ]
        },
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "VolumeSize": 50,
              "VolumeType": "gp3"
            }
          }
        ],
        "IamInstanceProfile": {
          "Ref": "Worker4InstanceProfileEAEB7A34"
        },
        "ImageId": {
          "Ref": "SsmParameterValueawsserviceamiamazonlinuxlatestamzn2amihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter"
        },
        "InstanceType": "t3.medium",
        "SecurityGroupIds": [
          {
            "Fn::GetAtt": [
              "Worker4InstanceSecurityGroupAB185FF0",
              "GroupId"
            ]
          }
        ],
        "SubnetId": {
          "Ref": "vpcPrivateSubnet1Subnet934893E8"
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "ShuffleShardingDemoSummit2022/Worker4"
          }
        ],
        "UserData": {
          "Fn::Base64": "#!/bin/bash -x\nyum update -y\nyum install python-pip -y\npip install flask\npip install boto3\npip install ec2-metadata\ncurl -o /home/ec2-user/buggy-webserver.py https://aws-well-architected-labs-virginia.s3.amazonaws.com/Reliability/300_Fault_Isolation_with_Shuffle_Sharding/buggy-webserver.py\nnohup python /home/ec2-user/buggy-webserver.py >>/var/log/webserver.log 2>&1 &"
        }
      },
      "DependsOn": [
        "Worker4InstanceRoleA8AACB09"
      ],
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker4/Resource"
      }
    },
    "Worker4readTags9AD8236D": {
      "Type": "AWS::IAM::ManagedPolicy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "ec2:DescribeTags",
              "Effect": "Allow",
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "Description": "",
        "Path": "/"
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker4readTags/Resource"
      }
    },
    "Worker1Worker204A96BDA": {
      "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
      "Properties": {
        "HealthCheckEnabled": true,
        "HealthCheckIntervalSeconds": 5,
        "HealthCheckPath": "/",
        "HealthCheckProtocol": "HTTP",
        "HealthCheckTimeoutSeconds": 2,
        "HealthyThresholdCount": 2,
        "Port": 80,
        "Protocol": "HTTP",
        "TargetGroupAttributes": [
          {
            "Key": "stickiness.enabled",
            "Value": "false"
          }
        ],
        "Targets": [
          {
            "Id": {
              "Ref": "Worker1C6282B125756e0f615c1f3fd"
            },
            "Port": 80
          },
          {
            "Id": {
              "Ref": "Worker21CDE475D5756e0f615c1f3fd"
            },
            "Port": 80
          }
        ],
        "TargetType": "instance",
        "UnhealthyThresholdCount": 2,
        "VpcId": {
          "Ref": "vpcA2121C38"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker1-Worker2/Resource"
      }
    },
    "canary1ArtifactsBucket33D896F3": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "BucketEncryption": {
          "ServerSideEncryptionConfiguration": [
            {
              "ServerSideEncryptionByDefault": {
                "SSEAlgorithm": "aws:kms"
              }
            }
          ]
        }
      },
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain",
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-1/ArtifactsBucket/Resource"
      }
    },
    "canary1ArtifactsBucketPolicy07FC42D3": {
      "Type": "AWS::S3::BucketPolicy",
      "Properties": {
        "Bucket": {
          "Ref": "canary1ArtifactsBucket33D896F3"
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:*",
              "Condition": {
                "Bool": {
                  "aws:SecureTransport": "false"
                }
              },
              "Effect": "Deny",
              "Principal": {
                "AWS": "*"
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "canary1ArtifactsBucket33D896F3",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "canary1ArtifactsBucket33D896F3",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-1/ArtifactsBucket/Policy/Resource"
      }
    },
    "canary1ServiceRole5838E95C": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": "s3:ListAllMyBuckets",
                  "Effect": "Allow",
                  "Resource": "*"
                },
                {
                  "Action": "s3:GetBucketLocation",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::GetAtt": [
                      "canary1ArtifactsBucket33D896F3",
                      "Arn"
                    ]
                  }
                },
                {
                  "Action": "s3:PutObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        {
                          "Fn::GetAtt": [
                            "canary1ArtifactsBucket33D896F3",
                            "Arn"
                          ]
                        },
                        "/*"
                      ]
                    ]
                  }
                },
                {
                  "Action": "cloudwatch:PutMetricData",
                  "Condition": {
                    "StringEquals": {
                      "cloudwatch:namespace": "CloudWatchSynthetics"
                    }
                  },
                  "Effect": "Allow",
                  "Resource": "*"
                },
                {
                  "Action": [
                    "logs:CreateLogStream",
                    "logs:CreateLogGroup",
                    "logs:PutLogEvents"
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition"
                        },
                        ":logs:",
                        {
                          "Ref": "AWS::Region"
                        },
                        ":",
                        {
                          "Ref": "AWS::AccountId"
                        },
                        ":log-group:/aws/lambda/cwsyn-*"
                      ]
                    ]
                  }
                }
              ],
              "Version": "2012-10-17"
            },
            "PolicyName": "canaryPolicy"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-1/ServiceRole/Resource"
      }
    },
    "canary14080B0CD": {
      "Type": "AWS::Synthetics::Canary",
      "Properties": {
        "ArtifactS3Location": {
          "Fn::Join": [
            "",
            [
              "s3://",
              {
                "Ref": "canary1ArtifactsBucket33D896F3"
              }
            ]
          ]
        },
        "Code": {
          "Handler": "index.handler",
          "Script": {
            "Fn::Join": [
              "",
              [
                "\n    const synthetics = require('Synthetics');\n    const log = require('SyntheticsLogger');\n    \n    const pageLoadBlueprint = async function () {\n    const url = 'http://",
                {
                  "Fn::GetAtt": [
                    "AppLoadBalancer0268F95E",
                    "DNSName"
                  ]
                },
                "/?number=1';\n\n    const page = await synthetics.getPage();\n    const response = await page.goto(url, { waitUntil: 'domcontentloaded', timeout: 30000 });\n    // Wait for page to render. Increase or decrease wait time based on endpoint being monitored.\n    await page.waitFor(15000);\n    // This will take a screenshot that will be included in test output artifacts.\n    await synthetics.takeScreenshot('loaded', 'loaded');\n    const pageTitle = await page.title();\n    log.info('Page title: ' + pageTitle);\n    if (response.status() !== 200) {\n      throw 'Failed to load page!';\n    }\n    };\n\n    exports.handler = async () => {\n      return await pageLoadBlueprint();\n    };\n    "
              ]
            ]
          }
        },
        "ExecutionRoleArn": {
          "Fn::GetAtt": [
            "canary1ServiceRole5838E95C",
            "Arn"
          ]
        },
        "Name": "shuffleshardinge2181d",
        "RuntimeVersion": "syn-nodejs-puppeteer-3.4",
        "Schedule": {
          "DurationInSeconds": "0",
          "Expression": "rate(5 minutes)"
        },
        "StartCanaryAfterCreation": true
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-1/Resource"
      }
    },
    "alarm11F7E5553": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "ComparisonOperator": "LessThanThreshold",
        "EvaluationPeriods": 5,
        "Dimensions": [
          {
            "Name": "CanaryName",
            "Value": {
              "Ref": "canary14080B0CD"
            }
          }
        ],
        "MetricName": "SuccessPercent",
        "Namespace": "CloudWatchSynthetics",
        "Period": 60,
        "Statistic": "Average",
        "Threshold": 90
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/alarm-1/Resource"
      }
    },
    "Worker3Worker4B1041CD7": {
      "Type": "AWS::ElasticLoadBalancingV2::TargetGroup",
      "Properties": {
        "HealthCheckEnabled": true,
        "HealthCheckIntervalSeconds": 5,
        "HealthCheckPath": "/",
        "HealthCheckProtocol": "HTTP",
        "HealthCheckTimeoutSeconds": 2,
        "HealthyThresholdCount": 2,
        "Port": 80,
        "Protocol": "HTTP",
        "TargetGroupAttributes": [
          {
            "Key": "stickiness.enabled",
            "Value": "false"
          }
        ],
        "Targets": [
          {
            "Id": {
              "Ref": "Worker356A1B6C45756e0f615c1f3fd"
            },
            "Port": 80
          },
          {
            "Id": {
              "Ref": "Worker49A67C52E5756e0f615c1f3fd"
            },
            "Port": 80
          }
        ],
        "TargetType": "instance",
        "UnhealthyThresholdCount": 2,
        "VpcId": {
          "Ref": "vpcA2121C38"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/Worker3-Worker4/Resource"
      }
    },
    "canary2ArtifactsBucket21016E4A": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "BucketEncryption": {
          "ServerSideEncryptionConfiguration": [
            {
              "ServerSideEncryptionByDefault": {
                "SSEAlgorithm": "aws:kms"
              }
            }
          ]
        }
      },
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain",
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-2/ArtifactsBucket/Resource"
      }
    },
    "canary2ArtifactsBucketPolicy8BB17232": {
      "Type": "AWS::S3::BucketPolicy",
      "Properties": {
        "Bucket": {
          "Ref": "canary2ArtifactsBucket21016E4A"
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:*",
              "Condition": {
                "Bool": {
                  "aws:SecureTransport": "false"
                }
              },
              "Effect": "Deny",
              "Principal": {
                "AWS": "*"
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "canary2ArtifactsBucket21016E4A",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "canary2ArtifactsBucket21016E4A",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-2/ArtifactsBucket/Policy/Resource"
      }
    },
    "canary2ServiceRole7902C7AF": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": "s3:ListAllMyBuckets",
                  "Effect": "Allow",
                  "Resource": "*"
                },
                {
                  "Action": "s3:GetBucketLocation",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::GetAtt": [
                      "canary2ArtifactsBucket21016E4A",
                      "Arn"
                    ]
                  }
                },
                {
                  "Action": "s3:PutObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        {
                          "Fn::GetAtt": [
                            "canary2ArtifactsBucket21016E4A",
                            "Arn"
                          ]
                        },
                        "/*"
                      ]
                    ]
                  }
                },
                {
                  "Action": "cloudwatch:PutMetricData",
                  "Condition": {
                    "StringEquals": {
                      "cloudwatch:namespace": "CloudWatchSynthetics"
                    }
                  },
                  "Effect": "Allow",
                  "Resource": "*"
                },
                {
                  "Action": [
                    "logs:CreateLogStream",
                    "logs:CreateLogGroup",
                    "logs:PutLogEvents"
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition"
                        },
                        ":logs:",
                        {
                          "Ref": "AWS::Region"
                        },
                        ":",
                        {
                          "Ref": "AWS::AccountId"
                        },
                        ":log-group:/aws/lambda/cwsyn-*"
                      ]
                    ]
                  }
                }
              ],
              "Version": "2012-10-17"
            },
            "PolicyName": "canaryPolicy"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-2/ServiceRole/Resource"
      }
    },
    "canary29E18EC3E": {
      "Type": "AWS::Synthetics::Canary",
      "Properties": {
        "ArtifactS3Location": {
          "Fn::Join": [
            "",
            [
              "s3://",
              {
                "Ref": "canary2ArtifactsBucket21016E4A"
              }
            ]
          ]
        },
        "Code": {
          "Handler": "index.handler",
          "Script": {
            "Fn::Join": [
              "",
              [
                "\n    const synthetics = require('Synthetics');\n    const log = require('SyntheticsLogger');\n    \n    const pageLoadBlueprint = async function () {\n    const url = 'http://",
                {
                  "Fn::GetAtt": [
                    "AppLoadBalancer0268F95E",
                    "DNSName"
                  ]
                },
                "/?number=2';\n\n    const page = await synthetics.getPage();\n    const response = await page.goto(url, { waitUntil: 'domcontentloaded', timeout: 30000 });\n    // Wait for page to render. Increase or decrease wait time based on endpoint being monitored.\n    await page.waitFor(15000);\n    // This will take a screenshot that will be included in test output artifacts.\n    await synthetics.takeScreenshot('loaded', 'loaded');\n    const pageTitle = await page.title();\n    log.info('Page title: ' + pageTitle);\n    if (response.status() !== 200) {\n      throw 'Failed to load page!';\n    }\n    };\n\n    exports.handler = async () => {\n      return await pageLoadBlueprint();\n    };\n    "
              ]
            ]
          }
        },
        "ExecutionRoleArn": {
          "Fn::GetAtt": [
            "canary2ServiceRole7902C7AF",
            "Arn"
          ]
        },
        "Name": "shuffleshardingb7e912",
        "RuntimeVersion": "syn-nodejs-puppeteer-3.4",
        "Schedule": {
          "DurationInSeconds": "0",
          "Expression": "rate(5 minutes)"
        },
        "StartCanaryAfterCreation": true
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-2/Resource"
      }
    },
    "alarm2999D08C3": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "ComparisonOperator": "LessThanThreshold",
        "EvaluationPeriods": 5,
        "Dimensions": [
          {
            "Name": "CanaryName",
            "Value": {
              "Ref": "canary29E18EC3E"
            }
          }
        ],
        "MetricName": "SuccessPercent",
        "Namespace": "CloudWatchSynthetics",
        "Period": 60,
        "Statistic": "Average",
        "Threshold": 90
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/alarm-2/Resource"
      }
    },
    "redirectLogic8024F0FE": {
      "Type": "AWS::CloudFront::Function",
      "Properties": {
        "Name": "redirectToRandomShard",
        "AutoPublish": true,
        "FunctionCode": "function handler(event) {\n        var request = event.request;\n        var querystring = request.querystring;\n        if (!querystring['number']){\n          var newUri;\n          var randomkey = getRndInteger(1, 2);\n          newUri = '/?number=' + randomkey;\n          var response = {\n            statusCode: 302,\n            statusDescription: 'Found',\n            headers: {\n              location: { value: newUri },\n            },\n          };\n          return response;\n        }\n        return request;\n      }\n\n      function getRndInteger(min, max) {\n        min = Math.ceil(min); // rounds a number up to the next largest integer\n        max = Math.floor(max); // returns the largest integer less than or equal to a given number\n        return Math.floor(Math.random() * (max - min + 1) + min); //The maximum is inclusive and the minimum is inclusive\n      }\n",
        "FunctionConfig": {
          "Comment": "Function to redirect all incoming requests to /?number= + Random Number (i.e: /?number=1)",
          "Runtime": "cloudfront-js-1.0"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/redirectLogic/Resource"
      }
    },
    "policyE16B4B70": {
      "Type": "AWS::CloudFront::OriginRequestPolicy",
      "Properties": {
        "OriginRequestPolicyConfig": {
          "CookiesConfig": {
            "CookieBehavior": "none"
          },
          "HeadersConfig": {
            "HeaderBehavior": "none"
          },
          "Name": "ShuffleShardingDemoSummit2022policy61EA8E81",
          "QueryStringsConfig": {
            "QueryStringBehavior": "all"
          }
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/policy/Resource"
      }
    },
    "CloudFrontD198EC06": {
      "Type": "AWS::CloudFront::Distribution",
      "Properties": {
        "DistributionConfig": {
          "DefaultCacheBehavior": {
            "CachePolicyId": "4135ea2d-6df8-44a3-9df3-4b5a84be39ad",
            "Compress": true,
            "FunctionAssociations": [
              {
                "EventType": "viewer-request",
                "FunctionARN": {
                  "Fn::GetAtt": [
                    "redirectLogic8024F0FE",
                    "FunctionARN"
                  ]
                }
              }
            ],
            "OriginRequestPolicyId": {
              "Ref": "policyE16B4B70"
            },
            "TargetOriginId": "ShuffleShardingDemoSummit2022CloudFrontOrigin1C1A871C7",
            "ViewerProtocolPolicy": "allow-all"
          },
          "Enabled": true,
          "HttpVersion": "http2",
          "IPV6Enabled": true,
          "Origins": [
            {
              "CustomOriginConfig": {
                "OriginProtocolPolicy": "http-only",
                "OriginSSLProtocols": [
                  "TLSv1.2"
                ]
              },
              "DomainName": {
                "Fn::GetAtt": [
                  "AppLoadBalancer0268F95E",
                  "DNSName"
                ]
              },
              "Id": "ShuffleShardingDemoSummit2022CloudFrontOrigin1C1A871C7"
            }
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/CloudFront/Resource"
      }
    },
    "canarymainArtifactsBucket26B27643": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "BucketEncryption": {
          "ServerSideEncryptionConfiguration": [
            {
              "ServerSideEncryptionByDefault": {
                "SSEAlgorithm": "aws:kms"
              }
            }
          ]
        }
      },
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain",
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-main/ArtifactsBucket/Resource"
      }
    },
    "canarymainArtifactsBucketPolicy95B019C1": {
      "Type": "AWS::S3::BucketPolicy",
      "Properties": {
        "Bucket": {
          "Ref": "canarymainArtifactsBucket26B27643"
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:*",
              "Condition": {
                "Bool": {
                  "aws:SecureTransport": "false"
                }
              },
              "Effect": "Deny",
              "Principal": {
                "AWS": "*"
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "canarymainArtifactsBucket26B27643",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "canarymainArtifactsBucket26B27643",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-main/ArtifactsBucket/Policy/Resource"
      }
    },
    "canarymainServiceRole70CC7F6B": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": "s3:ListAllMyBuckets",
                  "Effect": "Allow",
                  "Resource": "*"
                },
                {
                  "Action": "s3:GetBucketLocation",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::GetAtt": [
                      "canarymainArtifactsBucket26B27643",
                      "Arn"
                    ]
                  }
                },
                {
                  "Action": "s3:PutObject",
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        {
                          "Fn::GetAtt": [
                            "canarymainArtifactsBucket26B27643",
                            "Arn"
                          ]
                        },
                        "/*"
                      ]
                    ]
                  }
                },
                {
                  "Action": "cloudwatch:PutMetricData",
                  "Condition": {
                    "StringEquals": {
                      "cloudwatch:namespace": "CloudWatchSynthetics"
                    }
                  },
                  "Effect": "Allow",
                  "Resource": "*"
                },
                {
                  "Action": [
                    "logs:CreateLogStream",
                    "logs:CreateLogGroup",
                    "logs:PutLogEvents"
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition"
                        },
                        ":logs:",
                        {
                          "Ref": "AWS::Region"
                        },
                        ":",
                        {
                          "Ref": "AWS::AccountId"
                        },
                        ":log-group:/aws/lambda/cwsyn-*"
                      ]
                    ]
                  }
                }
              ],
              "Version": "2012-10-17"
            },
            "PolicyName": "canaryPolicy"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-main/ServiceRole/Resource"
      }
    },
    "canarymainEB7F983A": {
      "Type": "AWS::Synthetics::Canary",
      "Properties": {
        "ArtifactS3Location": {
          "Fn::Join": [
            "",
            [
              "s3://",
              {
                "Ref": "canarymainArtifactsBucket26B27643"
              }
            ]
          ]
        },
        "Code": {
          "Handler": "index.handler",
          "Script": {
            "Fn::Join": [
              "",
              [
                "\n    const synthetics = require('Synthetics');\n    const log = require('SyntheticsLogger');\n    \n    const pageLoadBlueprint = async function () {\n    const url = 'https://",
                {
                  "Fn::GetAtt": [
                    "CloudFrontD198EC06",
                    "DomainName"
                  ]
                },
                "';\n\n    const page = await synthetics.getPage();\n    const response = await page.goto(url, { waitUntil: 'domcontentloaded', timeout: 30000 });\n    // Wait for page to render. Increase or decrease wait time based on endpoint being monitored.\n    await page.waitFor(15000);\n    // This will take a screenshot that will be included in test output artifacts.\n    await synthetics.takeScreenshot('loaded', 'loaded');\n    const pageTitle = await page.title();\n    log.info('Page title: ' + pageTitle);\n    if (response.status() !== 200) {\n      throw 'Failed to load page!';\n    }\n    };\n\n    exports.handler = async () => {\n      return await pageLoadBlueprint();\n    };\n    "
              ]
            ]
          }
        },
        "ExecutionRoleArn": {
          "Fn::GetAtt": [
            "canarymainServiceRole70CC7F6B",
            "Arn"
          ]
        },
        "Name": "shufflesharding32aa7c",
        "RuntimeVersion": "syn-nodejs-puppeteer-3.4",
        "Schedule": {
          "DurationInSeconds": "0",
          "Expression": "rate(5 minutes)"
        },
        "StartCanaryAfterCreation": true
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/canary-main/Resource"
      }
    },
    "alarmmainB23BFCDF": {
      "Type": "AWS::CloudWatch::Alarm",
      "Properties": {
        "ComparisonOperator": "LessThanThreshold",
        "EvaluationPeriods": 5,
        "Dimensions": [
          {
            "Name": "CanaryName",
            "Value": {
              "Ref": "canarymainEB7F983A"
            }
          }
        ],
        "MetricName": "SuccessPercent",
        "Namespace": "CloudWatchSynthetics",
        "Period": 60,
        "Statistic": "Average",
        "Threshold": 90
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/alarm-main/Resource"
      }
    },
    "CDKMetadata": {
      "Type": "AWS::CDK::Metadata",
      "Properties": {
        "Analytics": "v2:deflate64:H4sIAAAAAAAA/31TXW/bMAz8LXtX1KYrNuxtafqBANtqOEVfB1pmbDW25ElUgsDwfx9txbWDFXvi8XgkqJN0I9vlrbz+BEe/UPl+UelMtlsCtRdM/W5R3cj2tVFivTOvyVokIau02obMIPXchFIbCF8gq3DiJ27lvVUaSFvzLu7Bwybpwy+gJyA8wkkkTh8YToM3htAxHgVxk3O2It61rNGQ2KIKTtPpydnQDDv8l3goHHovNsYTGIX/1DcmCoYNoqYTqrIhPwKpUrb34MvMgst7yZSsKnB1Tw2gE1iBJ82NkGdQ8RhtigObumoadnJw5AfX7oYaur7zIp/rtCc0Z82IP6inIV7CRT7TvYAr2M/RllnaCQ21bFMbB4xxNCBxdqeZ+gkGCswTyxOHC7kgOuE/y/YuqH28wDOKYeqZ59xyMlQiG+Ul19Y8z52i3TtnDcn2MRg1Pp93/Ox0oU2KfwL62eiP6Hs2w+ksjDPmedeJFL0NLr6DBBzUSNHo50BNiC98Jllbk+uhVSy/yesFVE0J/I++nz/SVR+nM53r8VidMDZH+eavDsuv8gt3vXmtFy4Y0jXKNMa/Bo4+2poDAAA="
      },
      "Metadata": {
        "aws:cdk:path": "ShuffleShardingDemoSummit2022/CDKMetadata/Default"
      },
      "Condition": "CDKMetadataAvailable"
    }
  },
  "Parameters": {
    "SsmParameterValueawsserviceamiamazonlinuxlatestamzn2amihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter": {
      "Type": "AWS::SSM::Parameter::Value<AWS::EC2::Image::Id>",
      "Default": "/aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2"
    },
    "BootstrapVersion": {
      "Type": "AWS::SSM::Parameter::Value<String>",
      "Default": "/cdk-bootstrap/hnb659fds/version",
      "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
    }
  },
  "Outputs": {
    "LoadBalancerEndpointWorker1Worker2": {
      "Value": {
        "Fn::Join": [
          "",
          [
            "http://",
            {
              "Fn::GetAtt": [
                "AppLoadBalancer0268F95E",
                "DNSName"
              ]
            },
            "/?number=1"
          ]
        ]
      }
    },
    "LoadBalancerEndpointWorker3Worker4": {
      "Value": {
        "Fn::Join": [
          "",
          [
            "http://",
            {
              "Fn::GetAtt": [
                "AppLoadBalancer0268F95E",
                "DNSName"
              ]
            },
            "/?number=2"
          ]
        ]
      }
    },
    "CloudfrontURL": {
      "Value": {
        "Fn::Join": [
          "",
          [
            "https://",
            {
              "Fn::GetAtt": [
                "CloudFrontD198EC06",
                "DomainName"
              ]
            }
          ]
        ]
      }
    },
    "CloudwatchDashboardURL": {
      "Value": "https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#dashboards:name=ShuffleShardingSummit2022"
    }
  },
  "Conditions": {
    "CDKMetadataAvailable": {
      "Fn::Or": [
        {
          "Fn::Or": [
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "af-south-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "ap-east-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "ap-northeast-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "ap-northeast-2"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "ap-south-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "ap-southeast-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "ap-southeast-2"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "ca-central-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "cn-north-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "cn-northwest-1"
              ]
            }
          ]
        },
        {
          "Fn::Or": [
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "eu-central-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "eu-north-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "eu-south-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "eu-west-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "eu-west-2"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "eu-west-3"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "me-south-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "sa-east-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "us-east-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "us-east-2"
              ]
            }
          ]
        },
        {
          "Fn::Or": [
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "us-west-1"
              ]
            },
            {
              "Fn::Equals": [
                {
                  "Ref": "AWS::Region"
                },
                "us-west-2"
              ]
            }
          ]
        }
      ]
    }
  },
  "Rules": {
    "CheckBootstrapVersion": {
      "Assertions": [
        {
          "Assert": {
            "Fn::Not": [
              {
                "Fn::Contains": [
                  [
                    "1",
                    "2",
                    "3",
                    "4",
                    "5"
                  ],
                  {
                    "Ref": "BootstrapVersion"
                  }
                ]
              }
            ]
          },
          "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
        }
      ]
    }
  }
}